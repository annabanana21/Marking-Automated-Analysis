(this.webpackJsonpmarking=this.webpackJsonpmarking||[]).push([[0],{15:function(e,t,a){e.exports=a.p+"static/media/folder.64ea4406.svg"},33:function(e,t,a){e.exports=a.p+"static/media/home.742f0085.png"},35:function(e,t,a){e.exports=a(73)},40:function(e,t,a){},41:function(e,t,a){},59:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),c=a(31),r=a.n(c),l=(a(40),a(34)),s=a(3),i=a(2),u=(a(41),a(5)),m=a.n(u),d=a(1),p={isLoggedIn:JSON.parse(localStorage.getItem("isLoggedIn"))||!1,isLoggedInJira:JSON.parse(localStorage.getItem("isLoggedInJira"))||!1,jiraData:JSON.parse(localStorage.getItem("jiraData"))||null,user:JSON.parse(localStorage.getItem("user"))||null,client_id:"6bafcc20d274364fb660",redirect_uri:"http://localhost:3000",client_secret:"de390593f3b2709a8a81c972b5dd56711b8e16e6",proxy_url:"http://localhost:8080/authenticate"},g=function(e,t){switch(t.type){case"LOGIN":return localStorage.setItem("isLoggedIn",JSON.stringify(t.payload.isLoggedIn)),localStorage.setItem("user",JSON.stringify(t.payload.user)),Object(d.a)(Object(d.a)({},e),{},{isLoggedIn:t.payload.isLoggedIn,user:t.payload.user});case"LOGINJIRA":return localStorage.setItem("isLoggedInJira",JSON.stringify(t.payload.isLoggedInJira)),localStorage.setItem("jiraData",JSON.stringify(t.payload.data)),Object(d.a)(Object(d.a)({},e),{},{isLoggedInJira:t.payload.isLoggedInJira,jiraData:t.payload.data});case"LOGOUT":return localStorage.clear(),Object(d.a)(Object(d.a)({},e),{},{isLoggedIn:!1,user:null});default:return e}},f=Object(o.createContext)(),h=function(e){var t=Object(o.useReducer)(g,p),a=Object(s.a)(t,2),c=a[0],r=a[1];return n.a.createElement(f.Provider,{value:{state:c,dispatch:r}},e.children)},b={current:{},repoList:[],commits:[]},_=function(e,t){switch(t.type){case"UPDATE":return Object(d.a)(Object(d.a)({},e),{},{current:t.payload.repo,commits:[]});case"CREATE":return{repoList:t.payload.repoList,current:{},commits:[],pulls:[]};case"COMMITS":return Object(d.a)(Object(d.a)({},e),{},{commits:t.payload.commits,branches:t.payload.branches,collaborators:t.payload.collaborators});default:return e}},E=Object(o.createContext)(),O=function(e){var t=Object(o.useReducer)(_,b),a=Object(s.a)(t,2),c=a[0],r=a[1];return n.a.createElement(E.Provider,{value:{repoState:c,repoDispatch:r}},e.children)},v=(a(58),a(59),a(15)),j=a.n(v),y=function(e){var t=Object(o.useState)(!1),a=Object(s.a)(t,2),c=a[0],r=a[1],l=e.date,i=e.item;return n.a.createElement("div",{className:c?"repo__card--alt":"repo__card",onClick:function(t){return function(t,a){r(!c),e.repoFocus(t,a)}(t,i)}},n.a.createElement("img",{className:"repo__folder",src:j.a}),n.a.createElement("div",{className:"repo__owner-box"},n.a.createElement("div",{className:"repo__top"},n.a.createElement("h4",{className:c?"repo__title--alt":"repo__title"},i.name),n.a.createElement("h5",{className:c?"repo__owner--alt":"repo__owner"},i.owner.login)),n.a.createElement("p",{className:"repo__date"},"Last updated: "+l)))},N=(a(29),function(){var e=Object(o.useContext)(f),t=e.state,a=e.dispatch,c=Object(o.useState)({errorMessage:"",isLoading:!1}),r=Object(s.a)(c,2),l=r[0],u=r[1];if(console.log(t),Object(o.useEffect)((function(){console.log("hello");var e=window.location.href,t=e.includes("?code=");if(console.log(e,t),t){var o=e.split("?code=");window.history.pushState({},null,o[0]),u(Object(d.a)(Object(d.a)({},l),{},{isLoading:!0}));var n=o[1].split("&state=");console.log(n),m.a.post("http://localhost:8080/jira/auth",{code:n[0]}).then((function(e){console.log(e),a({type:"LOGINJIRA",payload:{isLoggedInJira:!0,data:{access_token:e.data.access_token,clientId:e.data.clientId}}})})).catch((function(e){console.log(e),u({isLoading:!1,errorMessage:"Sorry! Login failed"})}))}}),[]),t.isLoggedInJira)return n.a.createElement(i.a,{to:"/repos"});return n.a.createElement("section",{className:"container"},n.a.createElement("div",null,n.a.createElement("h1",null,"Welcome"),n.a.createElement("span",null,"Super amazing app"),n.a.createElement("span",null,l.errorMessage),n.a.createElement("div",{className:"login-container"},l.isLoading?n.a.createElement("div",{className:"loader-container"},n.a.createElement("div",{className:"loader"})):n.a.createElement(n.a.Fragment,null,n.a.createElement("a",{className:"login-link",href:"http://localhost:8080/jira/auth",onClick:function(){u(Object(d.a)(Object(d.a)({},l),{},{errorMessage:""}))}},n.a.createElement("span",null,"Login with Jira"))))))}),L=Object(i.g)((function(e){var t=Object(o.useContext)(f),a=t.state,c=(t.dispatch,Object(o.useContext)(E)),r=c.repoState,i=c.repoDispatch,u=Object(o.useState)(!1),d=Object(s.a)(u,2),p=d[0],g=d[1],h=Object(o.useState)([]),b=Object(s.a)(h,2),_=b[0],O=b[1],v=Object(o.useState)(!1),j=Object(s.a)(v,2),N=j[0],L=j[1];console.log(a);var S=function(t,a){if(p)O([].concat(Object(l.a)(_),[a]));else{var o=e.history.push;t.preventDefault(),i({type:"UPDATE",payload:{repo:a}}),o(e.match.path+"/"+a.id)}};Object(o.useEffect)((function(){!function(){var e=a.user.data,t=e.access_token,o=(e.scope,e.token_type,e.user);m.a.post("http://localhost:8080/marking/repos",{key:t,owner:o.login}).then((function(e){console.log(e.data),i({type:"CREATE",payload:{repoList:e.data.sort((function(e,t){return new Date(e.pushed_at).getTime()-new Date(t.pushed_at).getTime()<0?1:-1}))}})}))}()}),[]),Object(o.useEffect)((function(){}),[p]),Object(o.useEffect)((function(){var e=document.querySelector(".start__expand");N?(e.style.height="80vh",e.style.overflow="scroll"):(e.style.height="fit-content",e.style.overflow="auto")}),[N]),console.log(_);var I=n.a.createElement("button",{onClick:function(){L(!0)}},"Show All");return N&&(I=n.a.createElement("button",{onClick:function(){L(!1)}},"Show Less")),n.a.createElement("section",{className:"start"},n.a.createElement("h2",null,"Welcome ",a.user.data.user.login,"!"),n.a.createElement("div",{className:"start__box"},n.a.createElement("h4",null,"Most Recent"),n.a.createElement("div",{className:"start__expand"},r.repoList.length>0&&function(){var e=r.repoList;return N||(e=r.repoList.slice(0,3)),e.map((function(e){var t=new Date(e.pushed_at).toDateString();return console.log(t),n.a.createElement(y,{repoFocus:S,item:e,date:t})}))}()),I))})),S=(a(67),a(33)),I=a.n(S),w=function(){var e=Object(o.useContext)(f),t=e.state,a=e.dispatch,c=Object(o.useState)({errorMessage:"",isLoading:!1}),r=Object(s.a)(c,2),l=r[0],u=r[1];console.log(t);var p=t.client_id,g=t.redirect_uri;if(Object(o.useEffect)((function(){var e=window.location.href,o=e.includes("?code=");if(console.log(e,o),o){var n=e.split("?code=");window.history.pushState({},null,n[0]),u(Object(d.a)(Object(d.a)({},l),{},{isLoading:!0}));var c={client_id:t.client_id,redirect_uri:t.redirect_uri,client_secret:t.client_secret,code:n[1]},r=t.proxy_url;console.log(r),m.a.post(r,c).then((function(e){console.log(e),a({type:"LOGIN",payload:{user:e,isLoggedIn:!0}})})).catch((function(e){console.log(e),u({isLoading:!1,errorMessage:"Sorry! Login failed"})}))}}),[t,a]),t.isLoggedIn)return n.a.createElement(i.a,{to:"/repos"});return n.a.createElement("section",{className:"log"},n.a.createElement("h2",{className:"log__logo"},"automark"),n.a.createElement("div",{className:"log__blurb"},n.a.createElement("h1",{className:"log__title"},"Let automation do the work for you."),n.a.createElement("p",null,"With automark analyze student repositories, efficiently install workspaces, and run user-driven tests."),n.a.createElement("span",null,l.errorMessage),n.a.createElement("div",{className:"login-container"},n.a.createElement(n.a.Fragment,null,n.a.createElement("a",{className:"log__link",href:"https://github.com/login/oauth/authorize?scope=".concat(["user","repo"],"&client_id=").concat(p,"&redirect_uri=").concat(g),onClick:function(){u(Object(d.a)(Object(d.a)({},l),{},{errorMessage:""}))}},n.a.createElement("div",{className:"log__in"},"Login with GitHub"))))),n.a.createElement("img",{className:"log__img",src:I.a}))},k=a(10);a(68);function x(e,t){return 1===e?[e,t[0]]:[e,t[1]]}var C=function(e){var t=new Date(e),a=new Date,o=Math.abs(a-t)/1e3;return o<60?x(Math.floor(o),[" second ago"," seconds ago"]):o<3600?x(Math.floor(o/60),[" minute ago"," minutes ago"]):o<86400?x(Math.floor(o/60/60),[" hour ago"," hours ago"]):o>=86400&&o<604800?x(Math.floor(o/60/60/24),[" day ago"," days ago"]):o<2419200?x(Math.floor(o/60/60/24/7),[" week ago"," weeks ago"]):o>=2419200&&o<29030400?x(Math.floor(o/60/60/24/7/4),[" month ago"," months ago"]):o>29030400?x(Math.floor(o/60/60/24/7/4/12),[" year ago"," years ago"]):void 0},J=function(e){var t=Object(o.useContext)(E),a=t.repoState,c=t.repoDispatch,r=Object(o.useContext)(f),l=r.state,i=(r.dispatch,Object(o.useState)(!0)),u=Object(s.a)(i,2),d=u[0],p=u[1];console.log(a),console.log(l);var g=function(){m.a.all([m.a.post("http://localhost:8080/marking/commits",{owner:a.current.owner.login,key:l.user.data.access_token,repoName:a.current.name}),m.a.get(a.current.branches_url.replace("{/branch}","")+"?access_token=".concat(l.user.data.access_token)),m.a.get(a.current.collaborators_url.replace("{/collaborator}","")+"?access_token=".concat(l.user.data.access_token))]).then((function(e){c({type:"COMMITS",payload:{commits:e[0].data,branches:e[1].data,collaborators:e[2].data}}),p(!1)}))};return Object(o.useEffect)((function(){g()}),[]),Object(o.useEffect)((function(){g()}),[p]),d?n.a.createElement("div",null,"Loading..."):n.a.createElement("section",{className:"collab"},n.a.createElement("div",{className:"collab__cont"},n.a.createElement("div",{className:"collab__square"},n.a.createElement("div",{className:"collab__box"},n.a.createElement("div",{className:"collab__infograph"},"Total Commits:"),n.a.createElement("p",{className:"collab__heading"},a.commits.length)),n.a.createElement("div",{className:"collab__box"},n.a.createElement("div",{className:"collab__infograph"},"Last Updated:"),n.a.createElement("p",{className:"collab__heading"},C(a.current.updated_at)[0]),n.a.createElement("p",{className:"collab__heading--small"},C(a.current.updated_at)[1])),n.a.createElement("div",{className:"collab__box"}),n.a.createElement("div",{className:"collab__box"})),n.a.createElement("div",{className:"collab__active"},n.a.createElement("h5",{className:"collab__text"},"GitHub Analysis"),n.a.createElement(k.b,{to:e.path},n.a.createElement("div",{className:"collab__button"},"START")))))},M=(a(69),a(70),function(){var e=Object(o.useContext)(E),t=e.repoState;e.repoDispatch;return n.a.createElement("div",{className:"title"},n.a.createElement("h3",{className:"title__name"},t.current.name))});function D(e,t,a){e[t]?e[t][a]?e[t][a]++:e[t][a]=1:(e[t]={},e[t][a]=1)}function T(e,t,a,o){e[t][a]?e[t][a].push(o):e[t][a]=[o]}var R=function(e){var t={};return e.commits.forEach((function(e){var a;e.commit.author&&(a=e.author?e.author.login:e.commit.author.name,D(t,a,"commits"))})),e.pulls.forEach((function(e){var a=e.pull,o=a.user,n=a.body;if(o){var c=o.login;D(t,c,"pullRequests"),n&&T(t,c,"pullComment",n)}0!==e.comments&&e.comments.forEach((function(e){var a=e.user.login,o=e.body;T(t,a,"comments",o)}))})),t},A=(a(71),a(72),function(e){var t=Object(o.useContext)(E),a=t.repoState,c=(t.repoDispatch,e.name),r=e.collaborator,l=a.collaborators.find((function(e){return e.login===c}));return n.a.createElement("div",{className:"user"},n.a.createElement("img",{src:l?l.avatar_url:j.a,className:"user__pic"}),n.a.createElement("div",{className:"user__box"},n.a.createElement("h4",{className:"user__name"},c),n.a.createElement("div",{className:"user__data"},n.a.createElement("div",{className:"user__short"},n.a.createElement("h5",null,r.commits),n.a.createElement("p",null,"commits")),n.a.createElement("div",null,n.a.createElement("h5",null,r.pullRequests?r.pullRequests:0),n.a.createElement("p",null,"pull requests")))))}),G=function(){var e=Object(o.useContext)(f),t=e.state,a=(e.dispatch,Object(o.useContext)(E)),c=a.repoState,r=(a.repoDispatch,Object(o.useState)(null)),l=Object(s.a)(r,2),i=l[0],u=l[1],d=Object(o.useState)("http://localhost:8080/marking/analysis"),p=Object(s.a)(d,2),g=p[0];p[1];return Object(o.useEffect)((function(){m.a.post("http://localhost:8080/marking/analysis",{owner:c.current.owner.login,key:t.user.data.access_token,repoName:c.current.name}).then((function(e){console.log(c.commits),u(R({pulls:e.data,commits:c.commits}))})),console.log("hello")}),[g]),Object(o.useEffect)((function(){console.log(i)}),[i]),!!i&&n.a.createElement("section",{className:"any"},n.a.createElement("h2",{className:"any__title"},"Participation Breakdown"),Object.keys(i).map((function(e){return n.a.createElement(A,{collaborator:i[e],name:e})})))},q=function(e){var t=Object(o.useState)(""),a=Object(s.a)(t,2),c=a[0];a[1];return Object(o.useEffect)((function(){}),[]),Object(o.useEffect)((function(){}),[c]),console.log(),n.a.createElement("div",{className:"rep"},n.a.createElement(M,null),n.a.createElement(J,{path:e.match.url+"/analysis"}))};var P=function(){return n.a.createElement(h,null,n.a.createElement(O,null,n.a.createElement(k.a,null,n.a.createElement(i.d,null,n.a.createElement(i.b,{path:"/jira",component:N}),n.a.createElement(i.b,{path:"/repos/:repoId/analysis",component:G}),n.a.createElement(i.b,{path:"/repos/:repoId",component:q}),n.a.createElement(i.b,{path:"/repos",component:L}),n.a.createElement(i.b,{path:"/",component:w})))))};r.a.render(n.a.createElement(P,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.3ec0de02.chunk.js.map